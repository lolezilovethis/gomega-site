<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Claim Status â€“ Gomega</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container center">
    <h1>Check Your Claim Status</h1>
    <input type="text" id="claimId" placeholder="Enter your Claim ID" />
    <button id="checkBtn">Check Status</button>
    <div id="result" style="margin-top: 20px;"></div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCosaEc1xMspmr9Z0ykfI3_6Ksrp-3r5WM",
      authDomain: "gomega-65e3f.firebaseapp.com",
      projectId: "gomega-65e3f",
      storageBucket: "gomega-65e3f.appspot.com",
      messagingSenderId: "212961835634",
      appId: "1:212961835634:web:12330a07ff79668ea060eb"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    async function checkClaim() {
      document.getElementById("checkBtn").addEventListener("click", checkClaim);
      const claimId = document.getElementById("claimId").value.trim();
      const result = document.getElementById("result");
      result.textContent = "Loading...";

      if (!claimId) {
        result.textContent = "Please enter a Claim ID.";
        return;
      }

      try {
        const claimRef = doc(db, "claims", claimId);
        const docSnap = await getDoc(claimRef);

        if (docSnap.exists()) {
          const data = docSnap.data();
          const status = data.status || "pending";
          const submissionUrl = data.submissionUrl || `https://gomega.watch/claims.html?id=${claimId}`;

          result.innerHTML = `
            <p><strong>Status:</strong> ${status.charAt(0).toUpperCase() + status.slice(1)}</p>
            <p><a href="${submissionUrl}" target="_blank">View your submission here</a></p>
          `;
        } else {
          result.textContent = "No claim found with this ID.";
        }
      } catch (err) {
        result.textContent = "Error fetching claim. Please try again.";
        console.error(err);
      }
    }
  </script>
</body>
</html>
