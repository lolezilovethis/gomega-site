<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Help & Support ‚Äî Gomega Watch</title>

  <link rel="stylesheet" href="/style.css">
  <style>
    :root{--bg:#ffffff;--card:#f7f9fb;--muted:#6b7280;--accent:#00d4ff;--text:#0f1724}
    .dark{--bg:#0b0e12;--card:#0f1720;--muted:#9aa4b2;--accent:#00d4ff;--text:#e6eef6}
    html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial}
    body{background:var(--bg);color:var(--text);padding:20px;display:flex;flex-direction:column;align-items:center}
    .wrap{max-width:980px;width:100%}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .brand{display:flex;align-items:center;gap:12px}
    .brand img{height:44px}
    h1{margin:0;font-size:1.4rem}
    .controls{display:flex;gap:8px;align-items:center}
    .btn{background:var(--accent);color:#021124;padding:8px 12px;border-radius:8px;border:none;font-weight:600;cursor:pointer}
    .link-btn{background:transparent;color:var(--accent);border:1px solid transparent;padding:6px 10px;border-radius:8px;cursor:pointer}

    .hero{margin:18px 0;padding:18px;border-radius:12px;background:var(--card);display:flex;gap:18px;align-items:center}
    .hero .left{flex:1}

    .search-row{display:flex;gap:8px;margin:14px 0}
    .search{flex:1;padding:10px;border-radius:10px;border:1px solid #e6e6e6}

    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:14px}
    .card{background:var(--card);padding:14px;border-radius:10px}
    .card h3{margin:0 0 8px 0}

    .faq-list{margin-top:18px}
    details{background:var(--card);padding:12px;border-radius:8px;margin-bottom:8px}
    summary{cursor:pointer;font-weight:700}

    .steps{display:flex;flex-direction:column;gap:10px}
    .step{background:linear-gradient(180deg,#ffffff00, #00000000);padding:12px;border-radius:8px;border:1px dashed #e8eef2}

    footer{margin-top:28px;color:var(--muted);text-align:center}

    @media (max-width:900px){.grid{grid-template-columns:repeat(2,1fr)} }
    @media (max-width:600px){.grid{grid-template-columns:1fr}.hero{flex-direction:column}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <img src="/assets/logo.png" alt="Gomega logo" onerror="this.style.display='none'">
        <div>
          <h1>Help & Support</h1>
          <div style="font-size:0.9rem;color:var(--muted)">Guides, FAQs, and troubleshooting for Gomega Watch</div>
        </div>
      </div>

      <div class="controls">
        <button id="darkToggle" class="link-btn" aria-pressed="false">üåì Dark</button>
        <button class="btn" onclick="window.location.href='/add-script'">‚úèÔ∏è Add Script</button>
        <button class="link-btn" onclick="window.location.href='/scripts'">üìú Scripts</button>
      </div>
    </header>

    <section class="hero">
      <div class="left">
        <h2 style="margin-top:0">Need help? Start here.</h2>
        <p style="margin:6px 0 0;color:var(--muted)">Search the FAQs, follow step-by-step troubleshooting, or contact support if you can‚Äôt find an answer.</p>

        <div class="search-row">
          <input id="faqSearch" class="search" placeholder="Search help ‚Äî try: 'brand', 'ads', 'publish', 'copy'">
          <button id="openDiscord" class="btn">üí¨ Ask on Discord</button>
        </div>

        <div style="display:flex;gap:8px;margin-top:10px;flex-wrap:wrap">
          <button onclick="location.href='/activate'" class="link-btn">üîë Activate Browser</button>
          <button onclick="location.href='/browser'" class="link-btn">‚¨áÔ∏è Download Browser</button>
          <button onclick="location.href='/help#troubleshooting'" class="link-btn">üõ† Troubleshooting</button>
        </div>
      </div>

      <div style="width:260px">
        <div class="card">
          <h3>Quick Links</h3>
          <ul style="padding-left:18px;margin:8px 0 0 0;color:var(--muted)">
            <li><a href="/add-script">Make a Script</a></li>
            <li><a href="/scripts">Browse Scripts</a></li>
            <li><a href="/admin-optout">Admin Opt-Out</a></li>
            <li><a href="/activate">Activate Browser</a></li>
          </ul>
        </div>

        <div class="card" style="margin-top:10px">
          <h3>Contact</h3>
          <div style="font-size:0.95rem;color:var(--muted)">Support: <a href="mailto:gomegaassist@gmail.com">gomegaassist@gmail.com</a></div>
          <div style="margin-top:8px;color:var(--muted)">Discord: <a href="https://discord.gg/kZtW4y2Q7u">Join our server</a></div>
        </div>
      </div>
    </section>

    <section class="grid">
      <div class="card">
        <h3>How to publish a script</h3>
        <ol style="color:var(--muted);padding-left:18px;margin:8px 0 0 0">
          <li>Sign in to your account.</li>
          <li>Go to <strong>Make a Script</strong> and fill in the title, brand, and code.</li>
          <li>If you enable ads, choose how many viewers must open them to view your code.</li>
          <li>Click <strong>Publish Script</strong>. Your script is added to the review queue (or published immediately if your role allows).</li>
        </ol>
      </div>

      <div class="card">
        <h3>Earnings & Ads</h3>
        <p style="color:var(--muted)">If you opt into ads, viewers will be required to open the configured number of ad pages before seeing the script code. Earnings are handled by the publisher's connected account.</p>
      </div>

      <div class="card">
        <h3>Brand names</h3>
        <p style="color:var(--muted)">Brand names are unique and reserved per user. If you already have a brand your input will be locked. Use the brand availability indicator when choosing a name.</p>
      </div>
    </section>

    <section id="troubleshooting" style="margin-top:18px">
      <h2>Troubleshooting</h2>
      <div class="steps">
        <div class="step"><strong>Can't sign in?</strong>
          <div style="color:var(--muted);margin-top:6px">Make sure cookies are enabled and you are using the correct email. If your school account is blocked, contact your IT admin or use a personal email to register.</div>
        </div>

        <div class="step"><strong>Scripts show 'No scripts found'</strong>
          <div style="color:var(--muted);margin-top:6px">Try Refresh, check your network and if your still getting the error contact support</div>
        </div>

        <div class="step"><strong>Copy to clipboard fails</strong>
          <div style="color:var(--muted);margin-top:6px">Some browsers disallow clipboard writes on insecure contexts or without user gesture ‚Äî use the displayed 'Copy Script' button or highlight + Ctrl+C.</div>
        </div>

        <div class="step"><strong>Ads opening unexpectedly</strong>
          <div style="color:var(--muted);margin-top:6px">Ad providers sometimes open new tabs to serve impressions. If an ad provider misbehaves, report it on Discord with a screenshot and URL.</div>
        </div>
      </div>
    </section>

    <section class="faq-list">
      <h2>Frequently Asked Questions</h2>

      <details>
        <summary>Why can't I choose my brand name?</summary>
        <div style="color:var(--muted);margin-top:8px">Brands are unique. If a brand is taken it will show as unavailable. Owners can be changed only by contacting support.</div>
      </details>

      <details>
        <summary>How do I delete a script?</summary>
        <div style="color:var(--muted);margin-top:8px">Go to your script entry (you must be signed in with the publishing account). There will be a delete option for scripts you own. If missing, contact support.</div>
      </details>

      <details>
        <summary>How long does publish review take?</summary>
        <div style="color:var(--muted);margin-top:8px">Most publishes are instant. If your account is new or flagged, manual review may take longer ‚Äî typically 24‚Äì72 hours depending on volume.</div>
      </details>

      <details>
        <summary>I'm seeing 404s for any page or scripts ‚Äî what do I do?</summary>
        <div style="color:var(--muted);margin-top:8px">Confirm Your account is not banned if it is banned it would show BANNED FOR (time) otherwise its a issue with your internet.</div>
      </details>

      <details>
        <summary>How do I request an opt-out for my school?</summary>
        <div style="color:var(--muted);margin-top:8px">Use the <a href="/admin-optout">Admin Opt-Out</a> page. Only verified staff with a school email can submit requests.</div>
      </details>
    </section>

    <section style="margin-top:18px">
      <h2>Report a problem</h2>
      <p style="color:var(--muted)">If you can't resolve the issue, please contact support ‚Äî include a short description, your account email, and any console errors or screenshots.</p>
      <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px">
        <a class="btn" href="mailto:gomegaassist@gmail.com?subject=Gomega%20Support%20Request">üìß Email Support</a>
        <button id="reportDiscord" class="link-btn">üí¨ Report on Discord</button>
      </div>
    </section>

    <footer>
      <div>Still stuck? Join our Discord or email <a href="mailto:gomegaassist@gmail.com">gomegaassist@gmail.com</a>.</div>
      <div style="margin-top:6px;color:var(--muted)">¬© 2025 Gomega ‚Äî Built with care.</div>
    </footer>
  </div>

  <script>
    (async function () {
      // Lightweight auth guard: load firebase modules dynamically so we don't use top-level import declarations inside blocks
      try {
        const firebaseMod = await import('./js/firebase.js'); // your local firebase init module that exports `auth`
        // firebase-auth module from CDN (exports onAuthStateChanged)
        const fbAuthModule = await import('https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js');
        const auth = firebaseMod.auth;
        const onAuthStateChanged = fbAuthModule.onAuthStateChanged;
        if (auth && typeof onAuthStateChanged === 'function') {
          onAuthStateChanged(auth, user => { if (!user) location.href = '/'; });
        }
      } catch (e) {
        // If dynamic import fails (module not present on static hosting) we silently continue
        // so the help page still loads without error.
        console.warn('Firebase modules not loaded (auth guard skipped).', e);
      }

      // simple dark-mode toggle persisted to localStorage
      const btn = document.getElementById('darkToggle');
      const saved = localStorage.getItem('gomega_dark');
      function applyDark(val){
        if(val){
          document.documentElement.classList.add('dark');
          btn.textContent='‚òÄÔ∏è Light';
          btn.setAttribute('aria-pressed','true');
        } else {
          document.documentElement.classList.remove('dark');
          btn.textContent='üåì Dark';
          btn.setAttribute('aria-pressed','false');
        }
      }
      applyDark(saved === '1' || (saved === null && window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches));
      btn.addEventListener('click', ()=>{
        const on = !document.documentElement.classList.contains('dark');
        applyDark(on);
        localStorage.setItem('gomega_dark', on ? '1':'0');
      });

      // FAQ search: filter details elements
      const faqSearch = document.getElementById('faqSearch');
      if (faqSearch) {
        faqSearch.addEventListener('input', ()=>{
          const q = faqSearch.value.trim().toLowerCase();
          document.querySelectorAll('.faq-list details').forEach(d=>{
            const text = (d.textContent || '').toLowerCase();
            d.style.display = text.includes(q) ? '' : 'none';
          });
        });
      }

      // Discord / contact handlers
      const openDiscord = document.getElementById('openDiscord');
      if (openDiscord) openDiscord.addEventListener('click', ()=> window.open('https://discord.gg/kZtW4y2Q7u','_blank'));

      const reportDiscord = document.getElementById('reportDiscord');
      if (reportDiscord) reportDiscord.addEventListener('click', ()=> window.open('https://discord.gg/kZtW4y2Q7u','_blank'));
    })();
  </script>
</body>
</html>
